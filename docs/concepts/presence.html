<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Working with Presence · ChatEngine</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; Enable &lt;em&gt;Presence&lt;/em&gt; from the &lt;a href=&quot;https://admin.pubnub.com/&quot;&gt;Admin Dashboard&lt;/a&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Working with Presence · ChatEngine"/><meta property="og:type" content="website"/><meta property="og:url" content="https://pubnub.github.io/chatengine/"/><meta property="og:description" content="&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; Enable &lt;em&gt;Presence&lt;/em&gt; from the &lt;a href=&quot;https://admin.pubnub.com/&quot;&gt;Admin Dashboard&lt;/a&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
"/><meta property="og:image" content="https://pubnub.github.io/chatengine/img/chat-engine-logo.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://pubnub.github.io/chatengine/img/chat-engine-logo.png"/><link rel="shortcut icon" href="/chatengine/img/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/ir-black.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="/chat-resource-center/js/language-picker.js"></script><script type="text/javascript" src="/chat-resource-center/js/segment.js"></script><link rel="stylesheet" href="/chatengine/css/main.css"/><script src="/chatengine/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/chatengine/"><img class="logo" src="/chatengine/img/pubnub.svg" alt="ChatEngine"/><h2 class="headerTitleWithLogo">ChatEngine</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/chatengine/docs/overview" target="_self">Documentation</a></li><li class="siteNavGroupActive"><a href="/chatengine/docs/overview" target="_self">Developers</a></li><li class="siteNavGroupActive"><a href="/chatengine/docs/overview" target="_self">SDKs</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search...." title="Search...."/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Concepts</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Overview<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/chatengine/docs/overview">Overview</a></li><li class="navListItem"><a class="navItem" href="/chatengine/docs/users">Users</a></li><li class="navListItem"><a class="navItem" href="/chatengine/docs/channels">Channels</a></li><li class="navListItem"><a class="navItem" href="/chatengine/docs/messages">Messages</a></li><li class="navListItem"><a class="navItem" href="/chatengine/docs/security">Security</a></li><li class="navListItem"><a class="navItem" href="/chatengine/docs/functions">Functions</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Getting Started<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/chatengine/docs/tutorials/tutorial-javascript">JavaScript</a></li><li class="navListItem"><a class="navItem" href="/chatengine/docs/tutorials/tutorial-swift">Swift</a></li><li class="navListItem"><a class="navItem" href="/chatengine/docs/tutorials/tutorial-android">Android</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Concepts<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/chatengine/docs/concepts/connecting">Connect to PubNub</a></li><li class="navListItem"><a class="navItem" href="/chatengine/docs/concepts/channels">Manage Channels</a></li><li class="navListItem"><a class="navItem" href="/chatengine/docs/concepts/messages">Messages</a></li><li class="navListItem"><a class="navItem" href="/chatengine/docs/concepts/message-history">Message History</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/chatengine/docs/concepts/presence">Presence</a></li><li class="navListItem"><a class="navItem" href="/chatengine/docs/concepts/authentication">P2: Authentication</a></li><li class="navListItem"><a class="navItem" href="/chatengine/docs/concepts/authorization">Authorization</a></li><li class="navListItem"><a class="navItem" href="/chatengine/docs/concepts/push-notifications">Push Notifications</a></li><li class="navListItem"><a class="navItem" href="/chatengine/docs/concepts/encryption">Encryption</a></li><li class="navListItem"><a class="navItem" href="/chatengine/docs/concepts/admin-controls">P2: Admin Controls</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Phase 2: Best Practices<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/chatengine/docs/best-practices/best-practices">P2: Best Practices Overview</a></li><li class="navListItem"><a class="navItem" href="/chatengine/docs/best-practices/chatbot-integration">P2: Chatbot Integration</a></li><li class="navListItem"><a class="navItem" href="/chatengine/docs/best-practices/translation">P2: Language Translation</a></li><li class="navListItem"><a class="navItem" href="/chatengine/docs/best-practices/moderation">P2: Content Moderation</a></li><li class="navListItem"><a class="navItem" href="/chatengine/docs/best-practices/storage">P2: Store Messages Externally</a></li><li class="navListItem"><a class="navItem" href="/chatengine/docs/best-practices/high-occupancy-channels">P2: High Occupancy Events</a></li><li class="navListItem"><a class="navItem" href="/chatengine/docs/best-practices/friend-lists">P2: Friend Lists</a></li><li class="navListItem"><a class="navItem" href="/chatengine/docs/best-practices/rate-limiting">P2: Rate Limiting</a></li><li class="navListItem"><a class="navItem" href="/chatengine/docs/best-practices/location-tracking">P2: Location Tracking</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Reference<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/chatengine/docs/resources/resources">Reference</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              const headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                if (event.target.tagName === 'A') {
                  document.body.classList.remove('tocActive');
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/pubnub/chat-resource-center/edit/master/docs/concepts/presence.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 class="postHeaderTitle">Working with Presence</h1></header><article><div><span><blockquote>
<p><strong>Note:</strong> Enable <em>Presence</em> from the <a href="https://admin.pubnub.com/">Admin Dashboard</a>.</p>
</blockquote>
<p>Presence enables you to track the online and offline status of users and devices in realtime, as well as store custom state information. PubNub automatically creates a presence channel for each channel. Subscribing to a presence channel or presence channel group will only return presence events.</p>
<p>The presence channel is the name of the original channel with <code>-pnpres</code> appended to the the name. For example, the presence channel for the channel <code>myChatRoom</code> is <code>myChatRoom-pnpres</code>. Presence exists for channel groups as well; if the channel group is <code>myChannelGroup</code>, the presence channel group becomes <code>myChannelGroup-pnpres</code>.</p>
<h2><a class="anchor" aria-hidden="true" id="receiving-presence-events"></a><a href="#receiving-presence-events" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Receiving presence events</h2>
<p>You  can enable realtime presence events when you subscribe to channels by enabling the <code>withPresence</code> flag or adding individual presence channels to the list of channels. The flag automatically adds presence channels to the subscribe list.</p>
<p>Once you are subscribed to presence channels, the listener will start receiving presence events.</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-185-tab-186" class="nav-link active" data-group="group_185" data-tab="tab-group-185-content-186">JavaScript</div><div id="tab-group-185-tab-187" class="nav-link" data-group="group_185" data-tab="tab-group-185-content-187">Swift</div><div id="tab-group-185-tab-188" class="nav-link" data-group="group_185" data-tab="tab-group-185-content-188">Java</div></div><div class="tab-content"><div id="tab-group-185-content-186" class="tab-pane active" data-group="group_185" tabindex="-1"><div><span><pre><code class="hljs css language-js">pubnub.subscribe({<br />  <span class="hljs-attr">channels</span>: [<span class="hljs-string">'room-1'</span>],<br />  <span class="hljs-attr">withPresence</span>: <span class="hljs-literal">true</span>,<br />});<br /></code></pre>
</span></div></div><div id="tab-group-185-content-187" class="tab-pane" data-group="group_185" tabindex="-1"><div><span><pre><code class="hljs css language-swift">pubnub.subscribe()<br />  .channels([<span class="hljs-string">"room-1"</span>])<br />  .withPresence(<span class="hljs-literal">true</span>)<br />  .perform()<br /></code></pre>
</span></div></div><div id="tab-group-185-content-188" class="tab-pane" data-group="group_185" tabindex="-1"><div><span><pre><code class="hljs css language-java"><span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> need a sample here</span><br /></code></pre>
</span></div></div></div></div>
<h2><a class="anchor" aria-hidden="true" id="presence-events"></a><a href="#presence-events" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Presence Events</h2>
<p>The following presence events may trigger when users subscribe or unsubscribe from channels:</p>
<ul>
<li><strong>join</strong> - A user subscribes to channel.</li>
<li><strong>leave</strong> - A user unsubscribes from channel.</li>
<li><strong>timeout</strong> - A timeout event is fired when a connection to a channel is severed and the subscriber has not been seen in 320 seconds (just over 5 minutes). This timeout interval can be customized using the heartbeat and heartbeat interval settings (SDK v3.6 or later).</li>
<li><strong>state-change</strong> - A state-change event will be fired anytime the state is changed using the state API (function signature varies by SDK).</li>
<li><strong>interval</strong> - An occupancy count is sent every 10 seconds (the default setting for the Presence Interval property, which is also configurable in the Presence add-on panel in your account dashboard).</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="join-event"></a><a href="#join-event" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Join Event</h3>
<pre><code class="hljs css language-json">{
    <span class="hljs-attr">"channel"</span>: <span class="hljs-string">"my_channel"</span>,
    <span class="hljs-attr">"subscription"</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">"actualChannel"</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">"subscribedChannel"</span>: <span class="hljs-string">"room-1-pnpres"</span>,
    <span class="hljs-attr">"action"</span>: <span class="hljs-string">"join"</span>,
    <span class="hljs-attr">"timetoken"</span>: <span class="hljs-string">"15119466699655811"</span>,
    <span class="hljs-attr">"occupancy"</span>: <span class="hljs-number">2</span>,
    <span class="hljs-attr">"uuid"</span>: <span class="hljs-string">"user1"</span>,
    <span class="hljs-attr">"timestamp"</span>: <span class="hljs-number">1511946669</span>
}
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="leave-event"></a><a href="#leave-event" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Leave Event</h3>
<pre><code class="hljs css language-json">{
    <span class="hljs-attr">"channel"</span>: <span class="hljs-string">"my_channel"</span>,
    <span class="hljs-attr">"subscription"</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">"actualChannel"</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">"subscribedChannel"</span>: <span class="hljs-string">"room-1-pnpres"</span>,
    <span class="hljs-attr">"action"</span>: <span class="hljs-string">"leave"</span>,
    <span class="hljs-attr">"timetoken"</span>: <span class="hljs-string">"15119446002445794"</span>,
    <span class="hljs-attr">"occupancy"</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">"uuid"</span>: <span class="hljs-string">"user1"</span>,
    <span class="hljs-attr">"timestamp"</span>: <span class="hljs-number">1511944600</span>
}
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="timeout-event"></a><a href="#timeout-event" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Timeout Event</h3>
<pre><code class="hljs css language-json">{
   <span class="hljs-attr">"channel"</span>: <span class="hljs-string">"my_channel"</span>,
   <span class="hljs-attr">"subscription"</span>: <span class="hljs-literal">null</span>,
   <span class="hljs-attr">"actualChannel"</span>: <span class="hljs-literal">null</span>,
   <span class="hljs-attr">"subscribedChannel"</span>: <span class="hljs-string">"room-1-pnpres"</span>,
   <span class="hljs-attr">"action"</span>: <span class="hljs-string">"timeout"</span>,
   <span class="hljs-attr">"timetoken"</span>: <span class="hljs-string">"15119519897494311"</span>,
   <span class="hljs-attr">"occupancy"</span>: <span class="hljs-number">3</span>,
   <span class="hljs-attr">"uuid"</span>: <span class="hljs-string">"user1"</span>,
   <span class="hljs-attr">"timestamp"</span>: <span class="hljs-number">1511951989</span>
}
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="custom-state-change-event"></a><a href="#custom-state-change-event" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Custom State Change Event</h3>
<pre><code class="hljs css language-json">{
    <span class="hljs-attr">"channel"</span>: <span class="hljs-string">"my_channel"</span>,
    <span class="hljs-attr">"subscription"</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">"actualChannel"</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">"subscribedChannel"</span>: <span class="hljs-string">"room-1-pnpres"</span>,
    <span class="hljs-attr">"action"</span>: <span class="hljs-string">"state-change"</span>,
    <span class="hljs-attr">"state"</span>: {
        <span class="hljs-attr">"mood"</span>: <span class="hljs-string">"grumpy"</span>
    },
    <span class="hljs-attr">"timetoken"</span>: <span class="hljs-string">"15119477895378127"</span>,
    <span class="hljs-attr">"occupancy"</span>: <span class="hljs-number">5</span>,
    <span class="hljs-attr">"uuid"</span>: <span class="hljs-string">"user1"</span>,
    <span class="hljs-attr">"timestamp"</span>: <span class="hljs-number">1511947789</span>
}
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="interval-event"></a><a href="#interval-event" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Interval Event</h3>
<pre><code class="hljs css language-json">{
    <span class="hljs-attr">"action"</span>: <span class="hljs-string">"interval"</span>,
    <span class="hljs-attr">"occupancy"</span>: <span class="hljs-number">2</span>,
    <span class="hljs-attr">"timestamp"</span>: <span class="hljs-number">1511947739</span>
}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="requesting-on-demand-presence-status"></a><a href="#requesting-on-demand-presence-status" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Requesting on-demand presence status</h2>
<p>You can obtain information about the current state of a channel, including a list of unique users currently subscribed to the channel, by calling the <code>hereNow()</code> function after the connection is established:</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-189-tab-190" class="nav-link active" data-group="group_189" data-tab="tab-group-189-content-190">JavaScript</div><div id="tab-group-189-tab-191" class="nav-link" data-group="group_189" data-tab="tab-group-189-content-191">Swift</div><div id="tab-group-189-tab-192" class="nav-link" data-group="group_189" data-tab="tab-group-189-content-192">Java</div></div><div class="tab-content"><div id="tab-group-189-content-190" class="tab-pane active" data-group="group_189" tabindex="-1"><div><span><pre><code class="hljs css language-js">pubnub.hereNow({<br />  <span class="hljs-attr">channels</span>: [<span class="hljs-string">'room-1'</span>],<br />  <span class="hljs-attr">includeUUIDs</span>: <span class="hljs-literal">true</span>,<br />  <span class="hljs-attr">includeState</span>: <span class="hljs-literal">true</span>,<br />}, (status, response) =&gt; {<br />  <span class="hljs-comment">// handle status, response</span><br />});<br /></code></pre>
</span></div></div><div id="tab-group-189-content-191" class="tab-pane" data-group="group_189" tabindex="-1"><div><span><pre><code class="hljs css language-swift">pubnub.presence().hereNow()<br />  .channel(<span class="hljs-string">"room-1"</span>)<br />  .verbosity(.state)<br />  .performWithCompletion({ (result, status) <span class="hljs-keyword">in</span><br />    <span class="hljs-comment">// handle status, response</span><br />  })<br /></code></pre>
</span></div></div><div id="tab-group-189-content-192" class="tab-pane" data-group="group_189" tabindex="-1"><div><span><pre><code class="hljs css language-java"><span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> need a sample here</span><br /></code></pre>
</span></div></div></div></div>
<h2><a class="anchor" aria-hidden="true" id="using-presence-web-hooks"></a><a href="#using-presence-web-hooks" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Using presence web hooks</h2>
<p>Presence Web Hooks provide a means for your server to be notified whenever presence events occur on any channel for your keys. This provides an easy to scale solution for your server side application to monitor the presence events.</p>
<p>Once your server's REST endpoints are implemented and the PubNub key configuration is in place, you are ready to go. But before you implement the REST endpoints, it might be helpful to know what the events' data looks like (content-type is application/json). Here is an example of a join:</p>
<pre><code class="hljs css language-http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/endpointname</span> HTTP/1.1

<span class="http"><span class="hljs-attribute">Content-Type</span>: application/json

<span class="1c">{
    'action': 'join',
    'sub_key': 'sub-c-...',
    'channel': 'lacrosse'
    'uuid': '<span class="hljs-number">1234-5678-90</span>ab-cdef',
    'timestamp': <span class="hljs-number">1440568311</span>,
    'occupancy': <span class="hljs-number">1</span>,
    'data': {'foo': 'bar'}
}
</span></span></code></pre>
<p>This would be the same for leave and timeout and state-change — except for the action value, of course. The data key/value would only be included if there was state data involved, but this is everything you need to consider.</p>
<p>For active and inactive, the content-type is multipart/form-data:</p>
<pre><code class="hljs css language-http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/endpointname</span> HTTP/1.1

<span class="http"><span class="hljs-attribute">Content-Type</span>: multipart/form-data

<span class="ini"><span class="hljs-attr">status</span>=active
<span class="hljs-attr">timestamp</span>=<span class="hljs-number">1440568311</span>
<span class="hljs-attr">sub_key</span>=sub-c-...
<span class="hljs-attr">channel</span>=lacrosse
</span></span></code></pre>
<p>Status value will be <code>active</code> or <code>inactive</code>.</p>
<p>It might be convenient to have separate endpoints for active/inactive and join/leave/timeout/state-change, but there is no reason it can't be all the same endpoint.</p>
<h2><a class="anchor" aria-hidden="true" id="showing-the-last-online-timestamp-for-a-user"></a><a href="#showing-the-last-online-timestamp-for-a-user" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Showing the last online timestamp for a user</h2>
<blockquote>
<p><strong>This is a low priority item for phase 1</strong></p>
</blockquote>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-193-tab-194" class="nav-link active" data-group="group_193" data-tab="tab-group-193-content-194">JavaScript</div><div id="tab-group-193-tab-195" class="nav-link" data-group="group_193" data-tab="tab-group-193-content-195">Swift</div><div id="tab-group-193-tab-196" class="nav-link" data-group="group_193" data-tab="tab-group-193-content-196">Java</div></div><div class="tab-content"><div id="tab-group-193-content-194" class="tab-pane active" data-group="group_193" tabindex="-1"><div><span><pre><code class="hljs css language-js"><span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> need a sample here</span><br /></code></pre>
</span></div></div><div id="tab-group-193-content-195" class="tab-pane" data-group="group_193" tabindex="-1"><div><span><pre><code class="hljs css language-swift"><span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> need a sample here</span><br /></code></pre>
</span></div></div><div id="tab-group-193-content-196" class="tab-pane" data-group="group_193" tabindex="-1"><div><span><pre><code class="hljs css language-java"><span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> need a sample here</span><br /></code></pre>
</span></div></div></div></div>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/chatengine/docs/concepts/message-history"><span class="arrow-prev">← </span><span>Message History</span></a><a class="docs-next button" href="/chatengine/docs/concepts/authentication"><span>P2: Authentication</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#receiving-presence-events">Receiving presence events</a></li><li><a href="#presence-events">Presence Events</a><ul class="toc-headings"><li><a href="#join-event">Join Event</a></li><li><a href="#leave-event">Leave Event</a></li><li><a href="#timeout-event">Timeout Event</a></li><li><a href="#custom-state-change-event">Custom State Change Event</a></li><li><a href="#interval-event">Interval Event</a></li></ul></li><li><a href="#requesting-on-demand-presence-status">Requesting on-demand presence status</a></li><li><a href="#using-presence-web-hooks">Using presence web hooks</a></li><li><a href="#showing-the-last-online-timestamp-for-a-user">Showing the last online timestamp for a user</a></li></ul></nav></div><footer id="footer" class="footer-section"><div id="footer-top"><div class="grey footer-top "><div class="container"><div class="row"><div class="footer-col-1 foot-col"><h4 class="footer-title">Solutions</h4><ul class=" footer-menu-list"><li><a title="ChatEngine" href="https://www.pubnub.com/products/chatengine/">ChatEngine<mark class="tm-mark">™</mark></a></li><li><a title="Project EON" href="https://www.pubnub.com/developers/eon/">Project EON</a></li><li><a title="Chat " href="https://www.pubnub.com/solutions/chat/">Chat </a></li><li><a title="IoT Device Control" href="https://www.pubnub.com/solutions/iot/">IoT Device Control</a></li><li><a title="Realtime Updates" href="https://www.pubnub.com/solutions/realtime-updates/">Realtime Updates</a></li><li><a title="Collaboration" href="https://www.pubnub.com/solutions/collaboration/">Collaboration </a></li><li><a title="Multiplayer Gaming" href="https://www.pubnub.com/solutions/multiplayer-games/">Multiplayer Gaming</a></li><li><a title="Healthcare" href="https://www.pubnub.com/solutions/healthcare/">Healthcare</a></li><li><a title="Cryptocurrency" href="https://www.pubnub.com/solutions/cryptocurrency/">Cryptocurrency</a></li><li><a title="WebRTC and VoIP Signaling" href="https://www.pubnub.com/solutions/webrtc-and-voip-signaling/">WebRTC and VoIP Signaling</a></li><li><a title="Customer Case Studies" href="https://www.pubnub.com/customers/">Customer Case Studies</a></li></ul></div><div class="footer-col-2 foot-col"><h4 class="footer-title">Features</h4><ul class="footer-menu-list"><li><a title="Data Stream Network" href="https://www.pubnub.com/products/global-data-stream-network/">Data Stream Network</a></li><li><a title="Realtime Messaging" href="https://www.pubnub.com/products/realtime-messaging/">Realtime Messaging</a></li><li><a title="Device &amp; User Presence" href="https://www.pubnub.com/products/presence/">Device &amp; User Presence</a></li><li><a title="PubNub Functions" href="https://www.pubnub.com/products/functions/">PubNub Functions</a></li><li><a title="Security &amp; Compliance" href="https://www.pubnub.com/products/security-overview/">Security &amp; Compliance</a></li><li><a title="GDPR Resource Center" href="https://www.pubnub.com/products/security/gdpr/">GDPR Resource Center</a></li><li><a title="Mobile Push Notifications" href="https://www.pubnub.com/products/mobile-push-notifications/"> Mobile Push Notifications</a></li><li><a title="Product Feature Updates" href="https://www.pubnub.com/docs/feature-updates">Product Feature Updates</a></li></ul></div><div class="footer-col-3 foot-col"><h4 class="footer-title">Developers</h4><ul class="footer-menu-list"><li><a title="70+ SDKs and Full Documentation" href="https://www.pubnub.com/docs">70+ SDKs and Full Documentation</a></li><li><a title="How PubNub Works" href="https://www.pubnub.com/developers/tech/how-pubnub-works/">How PubNub Works</a></li><li><a title="Quickstarts" href="https://www.pubnub.com/docs/getting-started-guides/pubnub-publish-subscribe">Quickstarts</a></li><li><a title="Tutorials &amp; Webinars" href="https://www.pubnub.com/developers/training/">Tutorials &amp; Webinars</a></li><li><a title="Dev Console" href="https://www.pubnub.com/docs/console">Dev Console</a></li><li><a title="Realtime Demo Applications" href="https://www.pubnub.com/developers/demos/">Realtime Demo Applications</a></li><li><a title="Realtime Data Streams Examples" href="https://www.pubnub.com/developers/realtime-data-streams/">Realtime Data Streams Examples</a></li></ul></div><div class="footer-col-4 foot-col"><h4 class="footer-title">Support</h4><ul class="footer-menu-list"><li><a title="Help &amp; Support" href="https://support.pubnub.com/support/home">Help &amp; Support</a></li><li><a title="Resource Center" href="https://www.pubnub.com/learn/resources/">Resource Center</a></li><li><a title="Knowledge Base" href="https://support.pubnub.com/support/solutions">Knowledge Base</a></li><li><a title="Glossary" href="https://www.pubnub.com/learn/glossary/">Glossary</a></li><li><a title="Professional Services" href="https://www.pubnub.com/services/professional-services/">Professional Services</a></li><li><a title="Network Status" target="_blank" rel="noopener" href="http://status.pubnub.com/">Network Status</a></li></ul> <a href="https://www.pubnub.com/schedule-a-demo/" title="Schedule a Demo" class="button-widget schedule-demo-footer">Schedule a Demo</a></div></div></div></div><div class="white  footer-top"><div class="container"><div class="row"><div class="foot-col"><a href="https://www.pubnub.com/" title="PubNub secure global data stream network and easy to use API for realtime Apps" class="footer-logo"></a></div><div class="foot-col"><ul class=" footer-menu-list"><li><a title="About PubNub" href="https://www.pubnub.com/company/">About PubNub</a></li><li><a title="Leadership" href="https://www.pubnub.com/company/leadership/">Leadership</a></li><li><a title="Careers" href="https://www.pubnub.com/company/careers/">Careers</a></li><li><a title="PubNub Ambassador" href="https://www.pubnub.com/pubnub-ambassador/">PubNub Ambassador</a></li></ul></div><div class="foot-col"><ul class=" footer-menu-list"><li><a title="Blog" href="https://www.pubnub.com/blog/">Blog</a></li><li><a title="Events" href="https://www.pubnub.com/company/events/">Events</a></li><li><a title="News Coverage" href="https://www.pubnub.com/company/news-coverage/">News Coverage</a></li><li><a title="Press Releases" href="https://www.pubnub.com/company/press-releases/">Press Releases</a></li></ul></div><div class="foot-col"><ul class=" footer-menu-list"><li><a title="Partnerships" href="https://www.pubnub.com/partners/">Partnerships</a></li><li><a title="Contact PubNub" href="https://www.pubnub.com/company/contact-us/">Contact PubNub</a></li><li><a title="Privacy Policy" href="https://www.pubnub.com/privacy-policy/">Privacy Policy</a></li><li><a title="Terms and Conditions" href="https://www.pubnub.com/terms-and-conditions/">Terms and Conditions</a></li></ul></div></div></div></div></div><div id="footer-bottom" class="footer-bottom"><div class="container"><div class="row  "><div class="bottom-left"><div class="copyright">© 2010 - 2019 PubNub Inc. All Rights Reserved. PUBNUB, ChatEngine, the PUBNUB logo and the ChatEngine logo are trademarks or registered trademarks of PubNub Inc. in the U.S. and other countries as well.</div></div><div class="bottom-right"><div class="social-footer"> <a rel="noopener" href="https://www.facebook.com/PubNub" class="social-link facebook" title="Follow PubNub on FaceBook" target="_blank">FaceBook</a>  <a rel="noopener" href="https://twitter.com/PubNub" class="social-link twitter" title="Follow PubNub on Twitter" target="_blank">Twitter</a><a rel="noopener" href="https://www.linkedin.com/company/pubnub" class="social-link linkedin" title="Follow PubNub on LinkedIn" target="_blank">LinkedIn</a><a rel="noopener" href="https://www.youtube.com/c/PubNub" class="social-link youtube" title="Follow PubNub on YouTube" target="_blank">YouTube</a><a rel="noopener" href="https://vimeo.com/pubnub" class="social-link vimeo" title="Follow PubNub on Vimeo" target="_blank">Vimeo</a></div></div></div></div></div></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '00b03685d9ddabed232cf720f6db94e6',
                indexName: 'dev_CRC',
                inputSelector: '#search_input_react',
                algoliaOptions: {}
              });
            </script></body></html>